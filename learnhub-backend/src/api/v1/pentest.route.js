const express = require('express');
const router = express.Router();
const pentestController = require('../../controllers/pentest.controller');

// ⚠️ PENTEST DEMO ROUTES - CHỈ DÙNG ĐỂ DEMO, KHÔNG DÙNG TRONG PRODUCTION ⚠️

// XSS Demo Routes
router.get('/xss/reflected', pentestController.xssReflected);
router.post('/xss/stored', pentestController.xssStored);
router.get('/xss/list', pentestController.xssList);

// SQL Injection Demo Routes
router.get('/sqli/search', pentestController.sqliSearch);
router.post('/sqli/login', pentestController.sqliLogin);
router.get('/sqli/user', pentestController.sqliUser);

// Info endpoint
router.get('/info', (req, res) => {
    res.json({
        message: 'Pentest Demo Endpoints',
        description: 'Các endpoint này chứa lỗ hổng cố ý để demo pentest',
        endpoints: {
            xss: {
                reflected: 'GET /api/v1/pentest/xss/reflected?search=<script>alert(1)</script>',
                stored: 'POST /api/v1/pentest/xss/stored {comment: "<script>alert(1)</script>"}',
                list: 'GET /api/v1/pentest/xss/list'
            },
            sqli: {
                search: 'GET /api/v1/pentest/sqli/search?query=admin\' OR \'1\'=\'1',
                login: 'POST /api/v1/pentest/sqli/login {username: "admin\' OR \'1\'=\'1--", password: "anything"}',
                user: 'GET /api/v1/pentest/sqli/user?id=1\' UNION SELECT username, password FROM users--'
            }
        },
        warning: '⚠️ KHÔNG SỬ DỤNG TRONG PRODUCTION!'
    });
});

module.exports = router;

